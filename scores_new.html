<html>

    <head>
        <title>Kenny vs. Spenny 2</title>
        <link rel="stylesheet" type="text/css" href="kvs.css" />
        <script src="rollovers.js" type="text/javascript"></script>
    </head>

    <body onload="setupRollovers();">

        <!-- HOMEPAGE HEADER -->
        <table cellpadding="0" cellspacing="0" width="750" class="center">
            <tr>
                <td valign="top" width="750">
                    <img src="media/header/home_header_kenny.gif" alt="Kenny" width="151" height="165"><a href="index.html"><img src="media/header/home_header_kvs.jpg" alt="Kenny vs. Spenny" width="438" height="165"></a><img src="media/header/home_header_spenny.gif" alt="Spenny" width="161" height="165">
                </td>
            </tr>
        </table>


        <!-- NAVBAR -->
        <table cellpadding="0" cellspacing="0" width="750" class="center">
            <tr>
                <td valign="top" width="750" background="media/navbar/nav_background.gif"> 
                    <img src="media/navbar/nav_filler.gif" alt="" width="48" height="30"><a href="competitions.html"><img src="media/navbar/nav_competitions_off.gif" hsrc="media/navbar/nav_competitions_on.gif" alt="Competitions" width="141" height="30"></a><img src="media/navbar/nav_filler.gif" alt="" width="25" height="30"><a href="bios.html"><img src="media/navbar/nav_bios_off.gif" alt="Bios" width="54" height="30" hsrc="media/navbar/nav_bios_on.gif"></a><img src="media/navbar/nav_filler.gif" alt="" width="25" height="30"><a href="freebies.html"><img src="media/navbar/nav_freebies_off.gif" alt="Freebies" width="100" height="30" hsrc="media/navbar/nav_freebies_on.gif"></a><img src="media/navbar/nav_filler.gif" alt="" width="25" height="30"><a href="outtakes.html"><img src="media/navbar/nav_outtakes_off.gif" alt="Outtakes" width="106" height="30" hsrc="media/navbar/nav_outtakes_on.gif"></a><img src="media/navbar/nav_filler.gif" alt="" width="25" height="30"><a href="game.html"><img src="media/navbar/nav_versusville_off.gif" alt="Play the Game" width="152" height="30" hsrc="media/navbar/nav_versusville_on.gif"></a><img src="media/navbar/nav_filler.gif" alt="" width="49" height="30">
                </td>
            </tr>
        </table>

        <!-- HEADER TEXT -->
        <table cellpadding="0" cellspacing="0" width="750" class="center">
            <tr>
                <td valign="top" width="750" style="background-color: #473923;">
                    <img src="media/subheaders/scoreboard.jpg" alt="Versusville Scoreboard" width="750" height="75">
                </td>
            </tr>

            <tr>
                <td valign="top" width="750" class="center" style="background-color: #473923;" colspan="3">
                    <img src="media/blank.gif" alt="" width="10" height="10">
                </td>
            </tr>

        </table>

        
        <table cellpadding="0" cellspacing="0" width="750" class="center">
            <tr>
                <td  valign="top" width="10" class="center" style="background-color: #473923;">
                    <img src="media/blank.gif" alt="" width="10" height="5">
                </td>
                

                <td valign="top" width="730" class="center" style="background-color: #473923; text-align: center;">

                    <img src="media/versusville/game_scores_lineup.gif" alt="" width="408" height="173">

                    <p style="text-align:center; color:#ffcc66;">These are the scoreboards for the 2021 patch</p>

                    <table cellpadding="5" cellspacing="2" width="100%">
                        <tr>
                            <td width="25%" valign="top">
                                <p style="text-align: center;">WASTEBALL</p>
                                <div id="wasteball"></div>
                            </td>
                            <td width="25%" valign="top">
                                <p style="text-align: center;">GRAVE RAVE</p>
                                <div id="graverave"></div>
                            </td>
                            <td width="25%" valign="top">
                                <p style="text-align: center;">KART DART SCORES</p>
                                <div id="kartdart"></div>
                            </td>
                            <td width="25%" valign="top">
                                <p style="text-align: center;">KART DART TIMES</p>
                                <div id="kartdart2"></div>
                            </td>
                        </tr>
                    </table>
                </td>

                <td valign="top" width="10" class="center" style="background-color: #473923;">
                    <img src="media/blank.gif" alt="" width="10" height="5">
                </td>
            </tr>
        </table>
        <!-- CONTENT END -->

        <script>

            function httpGetAsync(theUrl, callback) {
                var xmlHttp = new XMLHttpRequest();
                xmlHttp.onreadystatechange = function() { 
                    if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                        callback(xmlHttp.responseText);
                }
                xmlHttp.open("GET", theUrl, true); // true for asynchronous 
                xmlHttp.send();
            }

            httpGetAsync("https://servlet.versusville.com:3001/scores", function(res){
                console.log(res);
                var _data = JSON.parse(res)
                for(const [key, value] of Object.entries(_data)){
                    var wbTable = "<table cellpadding=\"5\" cellspacing=\"2\" width=\"100%\"><tr><td valign=\"top\" style=\"color:#ffcc66; background-color: #6c5630; font-weight: bold; text-align: left;\">Name</td><td valign=\"top\" style=\"color:#ffcc66; background-color: #6c5630; font-weight: bold; text-align: right;\">Score</td></tr>";
                    if(value.length >= 1){
                        var entries = value.sort(function(a, b){
                            if(a.score > b.score) return -1;
                            if(a.score < b.score) return 1;
                            return 0;
                        });

                        for(var i=0; i<entries.length; i++){
                            wbTable += "<tr><td style=\"color:#ffcc66; text-align: left;\">"
                            wbTable += "<b>#" + (i+1).toString() + "</b>   " + entries[i].username;
                            wbTable += "</td><td style=\"color:#ffcc66; text-align: right;\">";
                            wbTable += entries[i].score.toString();
                            wbTable += "</tr></td>"
                        }
                    }

                    wbTable += "</table>";

                    document.getElementById(key).innerHTML = wbTable;
                }
            });
        </script>

    </body>
</html>